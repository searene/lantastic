import {ContentState, convertFromHTML, convertToRaw, EditorState, Modifier} from "draft-js";
import {stateFromHTML} from 'draft-js-import-html';

export class RichEditorPasteHandler {
  getEditorStateFromHTML = (editorState: EditorState, html: string): EditorState => {
    console.log('fixed');
    const fixedHtml = `<meta http-equiv="content-type" content="text/html; charset=utf-8"><div class="dp-entry" style="box-sizing: inherit; margin: 10px 0px; font-size: 20px; font-weight: 700; color: rgba(0, 0, 0, 0.87); font-family: Lato, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><div class="dsl-headwords" style="box-sizing: inherit; font-weight: bold; margin-top: 15px; margin-bottom: 10px;"><p style="box-sizing: inherit; margin: 0px; line-height: 1.4285em; font-weight: bold; font-size: 15px;">search</p></div></div><div class="dp-definition" style="box-sizing: inherit; color: rgba(0, 0, 0, 0.87); font-family: Lato, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><div class="dsl-line" style="box-sizing: inherit;"><b class="dsl-b" style="box-sizing: inherit; font-weight: bold;">I.</b><span> </span><span style="box-sizing: inherit; color: blue;"><b class="dsl-b" style="box-sizing: inherit; font-weight: bold;">search</b></span><sup style="box-sizing: inherit; font-size: 10.5px; line-height: 0; position: relative; vertical-align: baseline; top: -0.5em;">1</sup><b class="dsl-b" style="box-sizing: inherit; font-weight: bold;"><span style="box-sizing: inherit; color: red;"><span> </span>S3</span></b><b class="dsl-b" style="box-sizing: inherit; font-weight: bold;"><span style="box-sizing: inherit; color: red;"><span> </span>W2</span></b><span> </span>/sɜːtʃ $ sɜːrtʃ/<span> </span><span class="dsl-p" style="box-sizing: inherit; color: green; font-style: italic;">AmE</span><span> </span><a class="dsl-audio" href="#" onclick="playAudio('dictp://audio:zip:/mnt/HDD/lantestic-test-dictionary/En-En-Longman_DOCE5.dsl.dz.files.zip:ame_search1.wav')" style="box-sizing: inherit; background-color: transparent; color: rgb(65, 131, 196); text-decoration: none;"><img class="sound-img" src="resources/dictionaries/sound.png" border="0" align="absmiddle" alt="Play" style="box-sizing: inherit; border-style: none; width: 25px; height: 25px;"><span> </span></a><span class="dsl-p" style="box-sizing: inherit; color: green; font-style: italic;">BrE</span><span> </span><a class="dsl-audio" href="#" onclick="playAudio('dictp://audio:zip:/mnt/HDD/lantestic-test-dictionary/En-En-Longman_DOCE5.dsl.dz.files.zip:bre_brelasdesearch.wav')" style="box-sizing: inherit; background-color: transparent; color: rgb(65, 131, 196); text-decoration: none;"><img class="sound-img" src="resources/dictionaries/sound.png" border="0" align="absmiddle" alt="Play" style="box-sizing: inherit; border-style: none; width: 25px; height: 25px;"><span> </span></a><i class="dsl-i" style="box-sizing: inherit; font-style: italic;"><span style="box-sizing: inherit; color: green;">noun</span></i></div><div class="dsl-line" style="box-sizing: inherit;"><div class="dsl-m2" style="box-sizing: inherit; padding-left: 18px;">[<span style="box-sizing: inherit; color: lightcoral;">Word Family:<span> </span></span><span style="box-sizing: inherit; color: green;">noun</span>: ↑<a class="dsl-ref" href="#" data-ref="search" onclick="{var button=document.getElementById('refer-word-search-button'); button.innerHTML='search'; button.click();}" style="box-sizing: inherit; background-color: transparent; color: blue; text-decoration: underline;">search</a>, ↑<a class="dsl-ref" href="#" data-ref="research" onclick="{var button=document.getElementById('refer-word-search-button'); button.innerHTML='research'; button.click();}" style="box-sizing: inherit; background-color: transparent; color: blue; text-decoration: underline;">research</a>, ↑<a class="dsl-ref" href="#" data-ref="researcher" onclick="{var button=document.getElementById('refer-word-search-button'); button.innerHTML='researcher'; button.click();}" style="box-sizing: inherit; background-color: transparent; color: blue; text-decoration: underline;">researcher</a>;<span> </span><span style="box-sizing: inherit; color: green;">verb</span>: ↑<a class="dsl-ref" href="#" data-ref="search" onclick="{var button=document.getElementById('refer-word-search-button'); button.innerHTML='search'; button.click();}" style="box-sizing: inherit; background-color: transparent; color: blue; text-decoration: underline;">search</a>, ↑<a class="dsl-ref" href="#" data-ref="research" onclick="{var button=document.getElementById('refer-word-search-button'); button.innerHTML='research'; button.click();}" style="box-sizing: inherit; background-color: transparent; color: blue; text-decoration: underline;">research</a>;<span> </span><span style="box-sizing: inherit; color: green;">adverb</span>: ↑<a class="dsl-ref" href="#" data-ref="searchingly" onclick="{var button=document.getElementById('refer-word-search-button'); button.innerHTML='searchingly'; button.click();}" style="box-sizing: inherit; background-color: transparent; color: blue; text-decoration: underline;">searchingly</a>;<span> </span><span style="box-sizing: inherit; color: green;">adjective</span>: ↑<a class="dsl-ref" href="#" data-ref="searching" onclick="{var button=document.getElementById('refer-word-search-button'); button.innerHTML='searching'; button.click();}" style="box-sizing: inherit; background-color: transparent; color: blue; text-decoration: underline;">searching</a>]</div></div><div class="dsl-line" style="box-sizing: inherit;"><div class="dsl-m2" style="box-sizing: inherit; padding-left: 18px;"><b class="dsl-b" style="box-sizing: inherit; font-weight: bold;">1</b>.<span> </span><span style="box-sizing: inherit; color: green;">[countable usually singular]</span><span> </span>an attempt to find someone or<span> </span></div></div></div>`;
    const blocksFromHTML = convertFromHTML(fixedHtml);
    const contentState = ContentState.createFromBlockArray(
      blocksFromHTML.contentBlocks,
      blocksFromHTML.entityMap
    );
    // const contentState = stateFromHTML(html);
    console.log(convertToRaw(contentState));
    return EditorState.push(editorState, contentState, 'insert-characters');
    // const dom = new DOMParser().parseFromString(html, 'text/html');
    // const body = dom.getElementsByTagName('body')[0];
    // const editorState = EditorState.createEmpty();
    // const contentState = editorState.getCurrentContent();
    // const selectionState = editorState.getSelection();
    // const contentStateWithEntity = contentState.createEntity(
    //   'LINK',
    //   'MUTABLE',
    //   {url: 'https://www.google.com'}
    // );
    // const entityKey = contentStateWithEntity.getLastCreatedEntityKey();
    // const contentStateWithLink = Modifier.applyEntity(
    //   contentStateWithEntity,
    //   selectionState,
    //   entityKey
    // );
    // return EditorState.push(editorState, contentStateWithLink, 'apply-entity');
  };
}